# Backup + Backup Tool: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—ç–∫–∞–ø–∞–º–∏

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–ò–¥–µ–∞–ª—å–Ω—ã–π —Å–∏–º–±–∏–æ–∑ –¥–≤—É—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

- **Backup** ‚Äî —Å–æ–∑–¥–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –±—ç–∫–∞–ø—ã
- **Backup Tool** ‚Äî –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É

## üèÜ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚ö° **–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
  - –ü–æ–∏—Å–∫ –ø–æ 100k+ —Ñ–∞–π–ª–æ–≤ –∑–∞ —Å–µ–∫—É–Ω–¥—ã
  - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (ThreadPoolExecutor)
  - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏

- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è**
  - Hardlinks –≤–º–µ—Å—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  - –¢–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞—Ö
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ

- üéØ **–¢–æ—á–µ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å**
  - –§–∏–ª—å—Ç—Ä—ã: —Ä–∞–∑–º–µ—Ä, –≤—Ä–µ–º—è, –º–∞—Å–∫–∏, –ø—É—Ç–∏
  - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
  - –°—É—Ö–æ–π –∑–∞–ø—É—Å–∫ (dry-run) –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

- üõ°Ô∏è **–ê–±—Å–æ–ª—é—Ç–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
  - Atomic-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
  - –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ—Ä—Ä—É–ø—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## üéØ –†–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üîç –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
python3 backup_tool.py /backups search \
  --mask "*.py" --mask "*.js" \
  --time ">2024-01-15" \
  --last-backups 7
```

### üßπ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
```bash
# –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –æ—á–∏—Å—Ç–∫–æ–π
python3 backup_tool.py /backups search \
  --mask "*.log" --mask "*.tmp" \
  --size ">100M"

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
python3 backup_tool.py /backups delete \
  backup_20231201 --mask "*.log" --mask "*.tmp"
```

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
```bash
# –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
python3 backup_tool.py /backups search \
  --mask "src/*.py:rec" \
  --json > project_stats.json
```

## ‚öôÔ∏è –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Ü–∏–∫–ª

```bash
# 1. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤
python3 backup.py --config config.json

# 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏–∑
python3 backup_tool.py /backups list --detailed
python3 backup_tool.py /backups search --mask "*.py" --time ">2024-01-01"

# 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
python3 backup_tool.py /backups delete old_backup --mask "*.tmp" --dry-run
python3 backup_tool.py /backups delete old_backup --mask "*.tmp"
```

## üåü –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏

### üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞
```python
# –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ –≤–º–µ—Å—Ç–æ —Ü–∏–∫–ª–æ–≤
new_files = current_tracked - old_mirror
deleted_files = old_mirror - current_tracked
updated_files = compare(size & mtime)
```

### üìä –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
```json
{
  "include_files": [".*", "*.txt:rec"],
  "exclude_files": ["*.tmp", "*.log:rec"]
}
```
- `:rec` ‚Äî —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫  
- –ë–µ–∑ `:rec` ‚Äî —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

### üé® –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–æ
```
üì¶ backup_20240101 (2024-01-01 14:30)

  üìÅ src/
     File name                    Size       Date    Status
     --------------------------   ---------  ----------  ------
     main.py                      1.2 KB     2024-01-01  ‚úÖ
     utils.py                     0.8 KB     2024-01-01  ‚úÖ
```

## üéØ –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è:

- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫–æ–≤ ‚Äî —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π
- –ê—Ä—Ö–∏–≤–∞—Ä–∏—É—Å–æ–≤ ‚Äî –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
git clone <your-repo>
cd backup-system

# –ù–∏–∫–∞–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!
python3 backup.py --help
python3 backup_tool.py --help
```

### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```json
{
  "src": "/home/user/data",
  "dist": "/backup/storage",
  "include_dirs": [".config", "Documents"],
  "exclude_files": ["*.tmp:rec", "*.log:rec"]
}
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- ‚è± –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏:
  - –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤: –Ω–∞ 70% –±—ã—Å—Ç—Ä–µ–µ
  - –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤: —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ –º–∏–Ω—É—Ç
  - –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π

- üí∞ –≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:
  - –ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ: –¥–æ 90% —ç–∫–æ–Ω–æ–º–∏–∏
  - –ü–∞–º—è—Ç—å: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
  - CPU: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Backup + Backup Tool = –ò–¥–µ–∞–ª—å–Ω–∞—è —Å–∏–Ω–µ—Ä–≥–∏—è**  

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –º–æ–∂–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å:

- ‚ö° –ú–æ—â—å enterprise-—Ä–µ—à–µ–Ω–∏–π
- üéØ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- üõ° –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º
- üíæ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±–ª–∞—á–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â

–ò–¥–µ–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ü–µ–Ω–∏—Ç —Å–≤–æ–µ –≤—Ä–µ–º—è –∏ –¥–∞–Ω–Ω—ã–µ! üèÜ
