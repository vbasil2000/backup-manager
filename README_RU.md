
# Python Backup Utility / Утилита резервного копирования на Python

## Описание
Утилита резервного копирования на Python без СУБД, полностью на стандартных библиотеках. Позволяет создавать независимые инкрементные бэкапы через hard links на mirror, минимизируя дублирование. Инкременты содержат только ссылки на mirror, удаленные треки корректно учитываются.

## Особенности
- Инкрементные бэкапы без дублирования данных (hard links).  
- Mirror каталог всегда отражает текущее состояние исходника.  
- Удаление файлов из mirror, если они удалены из исходника (track/included).  
- Метаданные инкрементов в JSON.  
- Полностью на стандартных библиотеках Python, без сторонних зависимостей.  
- Динамическая настройка через config.json, поддержка нескольких профилей (USB, второй диск, разные include/exclude).  
- Утилита `backup_tool.py` для поиска и восстановления файлов из инкрементов.  
- Легко бэкапить на съемные носители: скопировал USB, запустил `backup.py` — готово!  

## Структура проекта
```
backup_project/
├─ backup.py          # Основной скрипт бэкапа
├─ backup_tool.py     # Утилита для поиска/восстановления
├─ config.json        # Конфигурационный файл
├─ README.md          # Документация RU
├─ .gitignore         # Игнорируемые файлы
```

## Пример config.json
```json
{
  "src": "~/Documents",
  "dist": "~/Backups",
  "include_dirs": ["Projects", "Notes"],
  "track_dirs": ["Projects"],
  "include_files": ["todo.txt", "readme.md"],
  "track_files": ["todo.txt"],
  "exclude_dirs": ["Temp", "Cache"],
  "exclude_files": ["*.log", "*.tmp"],
  "max_workers": 8
}
```

## Алгоритм работы backup.py
1. **Сканирование:** рекурсивное сканирование src с учетом include/exclude правил.  
2. **Классификация:** разделение файлов на tracked и non-tracked.  
3. **Сравнение:** проверка изменений относительно текущего mirror.  
4. **Инкремент:** создание hard links для новых/измененных файлов и ссылок на удаленные треки.  
5. **Обновление mirror:** копирование новых/измененных файлов.  
6. **Очистка:** удаление файлов, отсутствующих в исходнике.  
7. **Метаданные:** генерация JSON с информацией о новых, измененных и удаленных файлах.  

## Использование
```bash
python3 backup.py              # Запуск бэкапа с config.json
python3 backup.py myconf.json  # Запуск с кастомным конфигом
python3 backup_tool.py         # Поиск/восстановление

python3 backup_tool.py recreate --force
python3 backup_tool.py /path/backup search --mask "*.py" --mask "*.pdf" --mask "*.md"


